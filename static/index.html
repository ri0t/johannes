<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>c-lib interface</title>


    <script src="scripts/jquery.min.js"></script>
    <script src="scripts/app.js"></script>

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="icon" sizes="196x196" href="images/touch/chrome-touch-icon-196x196.png">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="">

    <!-- Tile icon for Win8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="images/touch/ms-touch-icon-144x144-precomposed.png">
    <meta name="msapplication-TileColor" content="#3372DF">

    <!-- build:css styles/components/main.min.css -->
    <link rel="stylesheet" href="styles/h5bp.css">
    <!-- endbuild -->

</head>
<body>
<!-- Add your site or app content here -->
<form id="add_book">
    <span>ISBN:</span>
    <input type="text" name="isbn">
    <input type="submit" value="Submit">
</form>
<div id="status">Do something :)</div>


<div id="detailform">
<form id="details">
    <span>Authors:</span>
    <input type="text" name="authors">
    <span>Title</span>
    <input type="text" name="title">
    <span>Year</span>
    <input type="text" name="year">
    <span>Publisher</span>
    <input type="text" name="publisher">
    <hr>
    <span>Status</span>
    <input type="text" name="status">
    <span>Language</span>
    <input type="text" name="language">
    <span>Tags</span>
    <input type="text" name="tags">
    <span>Coordinates</span>
    <input type="text" name="coordinates">
    <span>Created</span>
    <input type="text" name="created">
    <span>Modified</span>
    <input type="text" name="modified">
    <hr>
    <span>Comment</span>
    <input type="text" name="comment">

</form>
</div>

<script lang="javascript">
$("#add_book").submit(function(e){

    e.preventDefault();

    var data = {}
    var Form = this;
    var FormStatus = $("#status")
    var Details = $("#details")
    var DetailForm = document.getElementById('detailform')

    //Gathering the Data
    //and removing undefined keys(buttons)
    $.each(this.elements, function(i, v){
            var input = $(v);
        data[input.attr("name")] = input.val();
        delete data["undefined"];
    });

    //Form Validation goes here....

    //Save Form Data........
    $.ajax({
        cache: false,
        url : "http://localhost:5000/c-lib/api/v1.0/books",
        type: "POST",
        dataType : "json",
        data : JSON.stringify(data),
        context : Form,
        success : function(callback){
            //Where $(this) => context == FORM
            console.log(callback);
            console.log(callback['book']);
            FormStatus.html("Success: " + callback['status']);
            $.each(callback['book'],function(key,value) {
                Details.find("input[name='"+key+"']").val(value);
            });
            DetailForm.style.display = 'block';

        },
        error : function(xhr, ajaxOptions, thrownError){
            console.log(xhr);
            DetailForm.style.display = 'none';
            FormStatus.html("Error: " + xhr['responseText']);
        }
    });
});
</script>



<!-- Built with kind love -->
</body>
</html>
